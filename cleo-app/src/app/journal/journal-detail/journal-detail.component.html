<mat-toolbar>
  <button
    mat-icon-button
    (click)="navigateBack()"
  >
    <mat-icon>
      keyboard_arrow_left
    </mat-icon>
  </button>

  <button
    *ngIf="(journal$.value) && (state$.value === 'normal')"
    mat-icon-button
    [matMenuTriggerFor]="menu"
  >
    <mat-icon>more_vert</mat-icon>
  </button>
  <mat-menu #menu="matMenu">
    <button
      mat-menu-item
      (click)="enterEditState()"
    >
      Edit
    </button>
    <button
      mat-menu-item
      (click)="deleteJournal()"
    >
      Delete
    </button>
  </mat-menu>

  <button
    *ngIf="(state$.value === 'edit')"
    mat-icon-button
    (click)="doneEditing()"
  >
    <mat-icon>done</mat-icon>
  </button>
</mat-toolbar>

<mat-progress-bar
  *ngIf="!(journal$.value)"
  mode="indeterminate"
></mat-progress-bar>

<div *ngIf="journal$.value">
  <h2
    *ngIf="(state$.value === 'normal')"
  >
    {{journal$.value.name}}
  </h2>
  <form
    *ngIf="(state$.value === 'edit')"
  >
    <mat-form-field>
      <textarea
        matInput
        [value]="journal$.value.name"
        name="name"
        type="text"
        formControlName="name"
        required
      ></textarea>
    </mat-form-field>
  </form>
  <p>{{journal$.value.dateOfCreation | date}} -
    {{journal$.value.lastUpdated | date}}</p>

  <button
    *ngIf="(state$.value === 'normal')"
    mat-button
    (click)="newEntry()"
  >
    Add Entry
  </button>

  <mat-list>
    <mat-list-item
      *ngFor="let entry of journalEntries$ | async"
    >
      <app-journal-entry-card
        [journalEntry]="entry"
      ></app-journal-entry-card>
    </mat-list-item>
  </mat-list>
</div>
